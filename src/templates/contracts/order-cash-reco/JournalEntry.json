{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "JournalEntry",
  "description": "Accounting system journal entry for reconciliation",
  "type": "object",
  "required": ["id", "entryNumber", "date", "status", "lines", "totalDebit", "totalCredit"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique journal entry identifier from accounting system"
    },
    "entryNumber": {
      "type": "string",
      "description": "Human-readable journal entry number"
    },
    "date": {
      "type": "string",
      "format": "date",
      "description": "Journal entry date"
    },
    "effectiveDate": {
      "type": "string",
      "format": "date",
      "description": "Effective date if different from entry date"
    },
    "status": {
      "type": "string",
      "enum": ["draft", "pending", "posted", "voided"],
      "description": "Journal entry status"
    },
    "type": {
      "type": "string",
      "enum": ["standard", "reversing", "recurring", "adjustment", "closing"],
      "description": "Journal entry type"
    },
    "source": {
      "type": "string",
      "enum": ["manual", "import", "system", "bank_feed", "sales", "purchase"],
      "description": "Source of the journal entry"
    },
    "reference": {
      "type": "string",
      "description": "Reference number or description"
    },
    "description": {
      "type": "string",
      "description": "Journal entry description or memo"
    },
    "currency": {
      "type": "string",
      "pattern": "^[A-Z]{3}$",
      "description": "Currency code (ISO 4217)"
    },
    "exchangeRate": {
      "type": "number",
      "description": "Exchange rate if foreign currency",
      "minimum": 0
    },
    "lines": {
      "type": "array",
      "description": "Journal entry line items",
      "minItems": 2,
      "items": {
        "type": "object",
        "required": ["accountCode", "amount", "type"],
        "properties": {
          "lineNumber": {
            "type": "integer",
            "description": "Line number for ordering"
          },
          "accountCode": {
            "type": "string",
            "description": "General ledger account code"
          },
          "accountName": {
            "type": "string",
            "description": "Account name for reference"
          },
          "accountType": {
            "type": "string",
            "enum": [
              "asset",
              "liability",
              "equity",
              "revenue",
              "expense",
              "other_income",
              "other_expense",
              "cost_of_goods_sold"
            ],
            "description": "Account type"
          },
          "amount": {
            "type": "number",
            "description": "Line amount (positive for debit, negative for credit in double-entry)"
          },
          "debitAmount": {
            "type": "number",
            "description": "Debit amount in cents",
            "minimum": 0
          },
          "creditAmount": {
            "type": "number",
            "description": "Credit amount in cents",
            "minimum": 0
          },
          "type": {
            "type": "string",
            "enum": ["debit", "credit"],
            "description": "Entry type"
          },
          "description": {
            "type": "string",
            "description": "Line item description"
          },
          "taxCode": {
            "type": "string",
            "description": "Tax code if applicable"
          },
          "taxAmount": {
            "type": "number",
            "description": "Tax amount in cents"
          },
          "trackingCategories": {
            "type": "array",
            "description": "Tracking categories for reporting",
            "items": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Category name (e.g., 'Department', 'Project')"
                },
                "option": {
                  "type": "string",
                  "description": "Selected option (e.g., 'Sales', 'Project-A')"
                }
              }
            }
          },
          "customer": {
            "type": "object",
            "description": "Associated customer if applicable",
            "properties": {
              "id": {
                "type": "string",
                "description": "Customer ID in accounting system"
              },
              "name": {
                "type": "string",
                "description": "Customer name"
              }
            }
          },
          "vendor": {
            "type": "object",
            "description": "Associated vendor if applicable",
            "properties": {
              "id": {
                "type": "string",
                "description": "Vendor ID in accounting system"
              },
              "name": {
                "type": "string",
                "description": "Vendor name"
              }
            }
          },
          "invoice": {
            "type": "object",
            "description": "Associated invoice if applicable",
            "properties": {
              "id": {
                "type": "string",
                "description": "Invoice ID"
              },
              "number": {
                "type": "string",
                "description": "Invoice number"
              }
            }
          },
          "payment": {
            "type": "object",
            "description": "Associated payment if applicable",
            "properties": {
              "id": {
                "type": "string",
                "description": "Payment ID"
              },
              "reference": {
                "type": "string",
                "description": "Payment reference"
              }
            }
          }
        }
      }
    },
    "totalDebit": {
      "type": "number",
      "description": "Total debit amount in cents",
      "minimum": 0
    },
    "totalCredit": {
      "type": "number",
      "description": "Total credit amount in cents",
      "minimum": 0
    },
    "attachments": {
      "type": "array",
      "description": "Attached documents",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Attachment ID"
          },
          "fileName": {
            "type": "string",
            "description": "File name"
          },
          "mimeType": {
            "type": "string",
            "description": "MIME type"
          },
          "url": {
            "type": "string",
            "format": "uri",
            "description": "Download URL"
          },
          "size": {
            "type": "integer",
            "description": "File size in bytes"
          }
        }
      }
    },
    "reconciliation": {
      "type": "object",
      "description": "Reconciliation metadata",
      "properties": {
        "reconciled": {
          "type": "boolean",
          "description": "Whether this entry has been reconciled"
        },
        "reconciledDate": {
          "type": "string",
          "format": "date-time",
          "description": "When reconciliation occurred"
        },
        "matchedTransactions": {
          "type": "array",
          "description": "Matched bank/payment transactions",
          "items": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "enum": ["order", "payout", "bank_transaction"],
                "description": "Type of matched transaction"
              },
              "id": {
                "type": "string",
                "description": "Transaction identifier"
              },
              "amount": {
                "type": "number",
                "description": "Matched amount"
              },
              "date": {
                "type": "string",
                "format": "date",
                "description": "Transaction date"
              }
            }
          }
        }
      }
    },
    "audit": {
      "type": "object",
      "description": "Audit trail information",
      "properties": {
        "createdBy": {
          "type": "string",
          "description": "User who created the entry"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Creation timestamp"
        },
        "modifiedBy": {
          "type": "string",
          "description": "User who last modified the entry"
        },
        "modifiedAt": {
          "type": "string",
          "format": "date-time",
          "description": "Last modification timestamp"
        },
        "approvedBy": {
          "type": "string",
          "description": "User who approved the entry"
        },
        "approvedAt": {
          "type": "string",
          "format": "date-time",
          "description": "Approval timestamp"
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Additional accounting system-specific data",
      "additionalProperties": true
    }
  }
}